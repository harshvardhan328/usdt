
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>USDT Flash Transfer (Ethereum Testnet)</title>
</head>
<body>
    <h1>USDT Flash Transfer on Ethereum Rinkeby Testnet</h1>
    <button id="connectBtn">Connect Wallet</button>
    <div id="walletAddress"></div>

    <h3>Send USDT</h3>
    <form id="transferForm">
        <input type="text" id="recipient" placeholder="Recipient Address" required size="50" />
        <input type="number" id="amount" placeholder="Amount USDT" required step="0.000001" min="0" />
        <button type="submit">Send</button>
    </form>

    <div id="status"></div>

    <script src="https://cdn.ethers.io/lib/ethers-5.2.umd.min.js" type="application/javascript"></script>
    <script>
        const provider = new ethers.providers.Web3Provider(window.ethereum, "any");
        let signer;

        async function connectWallet() {
            try {
                await provider.send("eth_requestAccounts", []);
                signer = provider.getSigner();
                const address = await signer.getAddress();
                document.getElementById("walletAddress").innerText = "Connected wallet: " + address;
                document.getElementById("status").innerText = "";
            } catch (error) {
                document.getElementById("status").innerText = "Error connecting wallet: " + error.message;
            }
        }

        document.getElementById("connectBtn").onclick = connectWallet;

        document.getElementById("transferForm").onsubmit = async (e) => {
            e.preventDefault();
            if (!signer) {
                alert("Please connect your wallet first!");
                return;
            }

            const recipient = document.getElementById("recipient").value.trim();
            const amount = document.getElementById("amount").value.trim();

            if (!ethers.utils.isAddress(recipient)) {
                alert("Invalid recipient address");
                return;
            }
            if (parseFloat(amount) <= 0) {
                alert("Amount must be positive");
                return;
            }

            const USDT_ADDRESS = "0x5592EC0cfb4dbc12D3aB100b257153436a1f0FEa"; // USDT on Rinkeby
            const abi = [
                "function transfer(address to, uint amount) public returns (bool)",
                "function balanceOf(address) view returns (uint)"
            ];

            const contract = new ethers.Contract(USDT_ADDRESS, abi, signer);

            try {
                const decimals = 6; // USDT decimals
                const amountParsed = ethers.utils.parseUnits(amount, decimals);
                const balance = await contract.balanceOf(await signer.getAddress());
                if (balance.lt(amountParsed)) {
                    document.getElementById("status").innerText = "Insufficient USDT balance.";
                    return;
                }
                const tx = await contract.transfer(recipient, amountParsed);
                document.getElementById("status").innerText = "Transaction sent. Waiting for confirmation...";
                await tx.wait();
                document.getElementById("status").innerText = "Transaction confirmed! TX Hash: " + tx.hash;
            } catch (error) {
                document.getElementById("status").innerText = "Transaction failed: " + error.message;
            }
        };
    </script>
</body>
</html>
